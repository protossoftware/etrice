plugins {
	id "cpp"
	id "de.protos.etrice-base"
}

dependencies {
	generator project(':plugins:org.eclipse.etrice.generator.cpp')
}

modelSet {
	room {
		module = 'etrice-cpp'
		source.srcDirs = ["model"]
		source.exclude '**/diagrams'
		option 'msc_instr'
	}
}

model {
	components {
		etrice_modellib_cpp(NativeLibrarySpec) {
			sources.cpp {
				builtBy generateRoom
				source {
					srcDirs = [modelSet.room.genDir]
					include '**/*.cpp'
				}
				exportedHeaders {
					srcDirs = [modelSet.room.genDir]
				}
				lib project: ':runtime:org.eclipse.etrice.runtime.cpp', library: 'etrice_runtime_cpp', linkage: 'api'
				lib project: ':runtime:org.eclipse.etrice.runtime.c', library: 'etrice_runtime_c', linkage: 'api'
			}
			binaries {
				withType(SharedLibraryBinarySpec) { buildable = false }
				all { cppCompiler.args '-g3' }
			}
		}
	}
}