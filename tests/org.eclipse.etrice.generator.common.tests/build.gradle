apply plugin: 'c'
apply plugin: 'cpp'
apply plugin: 'java-base'

apply from: "$rootDir/gradle/etTest.gradle"

def tests = [
	'actorCommunicationTest',
	'choicePointTest',
	'choicePointTestExtended',
	'dataDrivenTest',
	/* 'enumTest',		not supported in c++	*/
	'compileTest',
	'handlerTest',
	'operationInheritanceTest',
	'pingPongThreadTest',
	'pingPongThreadReplPortTest',
	'noInitialTransitionTest',
]

tests.each { name ->
	createTest('c', name)
	createTest('cpp', name)
	createTest('java', name)
}

// Enum Test
createTest('c', 'enumTest')
createTest('java', 'enumTest')

// DetailExpressionCompile Test
createTest('c', 'detailExpressionTest')
createTest('java', 'detailExpressionTest')

// VarargsTest
createTest('c', 'varargsTest')
createTest('java', 'varargsTest')

// SubSystemUserCodeTest
createTest('c', 'subSystemUserCodeTest')

// Contract Monitor Generation
createTest('c', 'contractMonitorTest')
createTest('java', 'contractMonitorTest')

dependencies {
	generator project(':plugins:org.eclipse.etrice.generator.contractmonitor')
}

modelSet {
	contractMonitor {
		module = 'etrice-contractmonitor'
		source.srcDirs = ['model/contractMonitorTest']
		source.include '**/*.room'
		modelpath.from configurations.modelpath_c
		genDir = layout.projectDirectory.dir('model-gen')
	}
	contractMonitorTestC.source.srcDir(contractMonitor.genDir)
	contractMonitorTestJava.source.srcDir(contractMonitor.genDir)
}
